import{s as te}from"./common/index-ab377199.js";function F(t){if(t)throw t}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var U=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)},O=Object.prototype.hasOwnProperty,D=Object.prototype.toString,k=Object.defineProperty,B=Object.getOwnPropertyDescriptor,H=function(e){return typeof Array.isArray=="function"?Array.isArray(e):D.call(e)==="[object Array]"},M=function(e){if(!e||D.call(e)!=="[object Object]")return!1;var n=O.call(e,"constructor"),o=e.constructor&&e.constructor.prototype&&O.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!o)return!1;var r;for(r in e);return typeof r=="undefined"||O.call(e,r)},Y=function(e,n){k&&n.name==="__proto__"?k(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},$=function(e,n){if(n==="__proto__")if(O.call(e,n)){if(B)return B(e,n).value}else return;return e[n]},q=function t(){var e,n,o,r,i,s,l=arguments[0],h=1,g=arguments.length,w=!1;for(typeof l=="boolean"&&(w=l,l=arguments[1]||{},h=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});h<g;++h)if(e=arguments[h],e!=null)for(n in e)o=$(l,n),r=$(e,n),l!==r&&(w&&r&&(M(r)||(i=H(r)))?(i?(i=!1,s=o&&H(o)?o:[]):s=o&&M(o)?o:{},Y(l,{name:n,newValue:t(w,s,r)})):typeof r!="undefined"&&Y(l,{name:n,newValue:r}));return l};function T(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function ne(){const t=[],e={run:n,use:o};return e;function n(...r){let i=-1;const s=r.pop();if(typeof s!="function")throw new TypeError("Expected function as last argument, not "+s);l(null,...r);function l(h,...g){const w=t[++i];let C=-1;if(h){s(h);return}for(;++C<r.length;)(g[C]===null||g[C]===void 0)&&(g[C]=r[C]);r=g,w?re(w,l)(...g):s(null,...g)}}function o(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return t.push(r),e}}function re(t,e){let n;return o;function o(...s){const l=t.length>s.length;let h;l&&s.push(r);try{h=t.apply(this,s)}catch(g){const w=g;if(l&&n)throw w;return r(w)}l||(h instanceof Promise?h.then(i,r):h instanceof Error?r(h):i(h))}function r(s,...l){n||(n=!0,e(s,...l))}function i(s){r(null,s)}}class m extends Error{constructor(e,n,o){const r=[null,null];let i={start:{line:null,column:null},end:{line:null,column:null}};super();if(typeof n=="string"&&(o=n,n=void 0),typeof o=="string"){const s=o.indexOf(":");s===-1?r[1]=o:(r[0]=o.slice(0,s),r[1]=o.slice(s+1))}n&&("type"in n||"position"in n?n.position&&(i=n.position):"start"in n||"end"in n?i=n:("line"in n||"column"in n)&&(i.start=n)),this.name=te(n)||"1:1",this.message=typeof e=="object"?e.message:e,this.stack=typeof e=="object"?e.stack:"",this.reason=this.message,this.fatal,this.line=i.start.line,this.column=i.start.column,this.source=r[0],this.ruleId=r[1],this.position=i,this.actual,this.expected,this.file,this.url,this.note}}m.prototype.file="",m.prototype.name="",m.prototype.reason="",m.prototype.message="",m.prototype.stack="",m.prototype.fatal=null,m.prototype.column=null,m.prototype.line=null,m.prototype.source=null,m.prototype.ruleId=null,m.prototype.position=null;const A={basename:ie,dirname:oe,extname:se,join:fe,sep:"/"};function ie(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');S(t);let n=0,o=-1,r=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;r--;)if(t.charCodeAt(r)===47){if(i){n=r+1;break}}else o<0&&(i=!0,o=r+1);return o<0?"":t.slice(n,o)}if(e===t)return"";let s=-1,l=e.length-1;for(;r--;)if(t.charCodeAt(r)===47){if(i){n=r+1;break}}else s<0&&(i=!0,s=r+1),l>-1&&(t.charCodeAt(r)===e.charCodeAt(l--)?l<0&&(o=r):(l=-1,o=s));return n===o?o=s:o<0&&(o=t.length),t.slice(n,o)}function oe(t){if(S(t),t.length===0)return".";let e=-1,n=t.length,o;for(;--n;)if(t.charCodeAt(n)===47){if(o){e=n;break}}else o||(o=!0);return e<0?t.charCodeAt(0)===47?"/":".":e===1&&t.charCodeAt(0)===47?"//":t.slice(0,e)}function se(t){S(t);let e=t.length,n=-1,o=0,r=-1,i=0,s;for(;e--;){const l=t.charCodeAt(e);if(l===47){if(s){o=e+1;break}continue}n<0&&(s=!0,n=e+1),l===46?r<0?r=e:i!==1&&(i=1):r>-1&&(i=-1)}return r<0||n<0||i===0||i===1&&r===n-1&&r===o+1?"":t.slice(r,n)}function fe(...t){let e=-1,n;for(;++e<t.length;)S(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":le(n)}function le(t){S(t);const e=t.charCodeAt(0)===47;let n=ce(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.charCodeAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function ce(t,e){let n="",o=0,r=-1,i=0,s=-1,l,h;for(;++s<=t.length;){if(s<t.length)l=t.charCodeAt(s);else{if(l===47)break;l=47}if(l===47){if(!(r===s-1||i===1))if(r!==s-1&&i===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){if(h=n.lastIndexOf("/"),h!==n.length-1){h<0?(n="",o=0):(n=n.slice(0,h),o=n.length-1-n.lastIndexOf("/")),r=s,i=0;continue}}else if(n.length>0){n="",o=0,r=s,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",o=2)}else n.length>0?n+="/"+t.slice(r+1,s):n=t.slice(r+1,s),o=s-r-1;r=s,i=0}else l===46&&i>-1?i++:i=-1}return n}function S(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const ue={cwd:ae};function ae(){return"/"}function _(t){return t!==null&&typeof t=="object"&&t.href&&t.origin}function he(t){if(typeof t=="string")t=new URL(t);else if(!_(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return pe(t)}function pe(t){if(t.hostname!==""){const o=new TypeError('File URL host must be "localhost" or empty on darwin');throw o.code="ERR_INVALID_FILE_URL_HOST",o}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.charCodeAt(n)===37&&e.charCodeAt(n+1)===50){const o=e.charCodeAt(n+2);if(o===70||o===102){const r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(e)}const R=["history","path","basename","stem","extname","dirname"];class de{constructor(e){let n;e?typeof e=="string"||U(e)?n={value:e}:_(e)?n={path:e}:n=e:n={},this.data={},this.messages=[],this.history=[],this.cwd=ue.cwd(),this.value,this.stored,this.result,this.map;let o=-1;for(;++o<R.length;){const i=R[o];i in n&&n[i]!==void 0&&(this[i]=i==="history"?[...n[i]]:n[i])}let r;for(r in n)R.includes(r)||(this[r]=n[r])}get path(){return this.history[this.history.length-1]}set path(e){_(e)&&(e=he(e)),L(e,"path"),this.path!==e&&this.history.push(e)}get dirname(){return typeof this.path=="string"?A.dirname(this.path):void 0}set dirname(e){G(this.basename,"dirname"),this.path=A.join(e||"",this.basename)}get basename(){return typeof this.path=="string"?A.basename(this.path):void 0}set basename(e){L(e,"basename"),j(e,"basename"),this.path=A.join(this.dirname||"",e)}get extname(){return typeof this.path=="string"?A.extname(this.path):void 0}set extname(e){if(j(e,"extname"),G(this.dirname,"extname"),e){if(e.charCodeAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=A.join(this.dirname,this.stem+(e||""))}get stem(){return typeof this.path=="string"?A.basename(this.path,this.extname):void 0}set stem(e){L(e,"stem"),j(e,"stem"),this.path=A.join(this.dirname||"",e+(this.extname||""))}toString(e){return(this.value||"").toString(e)}message(e,n,o){const r=new m(e,n,o);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}info(e,n,o){const r=this.message(e,n,o);return r.fatal=null,r}fail(e,n,o){const r=this.message(e,n,o);throw r.fatal=!0,r}}function j(t,e){if(t&&t.includes(A.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+A.sep+"`")}function L(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function G(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}const ye=K().freeze(),J={}.hasOwnProperty;function K(){const t=ne(),e=[];let n={},o,r=-1;return i.data=s,i.Parser=void 0,i.Compiler=void 0,i.freeze=l,i.attachers=e,i.use=h,i.parse=g,i.stringify=w,i.run=C,i.runSync=Z,i.process=v,i.processSync=ee,i;function i(){const f=K();let c=-1;for(;++c<e.length;)f.use(...e[c]);return f.data(q(!0,{},n)),f}function s(f,c){return typeof f=="string"?arguments.length===2?(N("data",o),n[f]=c,i):J.call(n,f)&&n[f]||null:f?(N("data",o),n=f,i):n}function l(){if(o)return i;for(;++r<e.length;){const[f,...c]=e[r];if(c[0]===!1)continue;c[0]===!0&&(c[0]=void 0);const u=f.call(i,...c);typeof u=="function"&&t.use(u)}return o=!0,r=Number.POSITIVE_INFINITY,i}function h(f,...c){let u;if(N("use",o),f!=null)if(typeof f=="function")x(f,...c);else if(typeof f=="object")Array.isArray(f)?P(f):b(f);else throw new TypeError("Expected usable value, not `"+f+"`");return u&&(n.settings=Object.assign(n.settings||{},u)),i;function d(a){if(typeof a=="function")x(a);else if(typeof a=="object")if(Array.isArray(a)){const[p,...y]=a;x(p,...y)}else b(a);else throw new TypeError("Expected usable value, not `"+a+"`")}function b(a){P(a.plugins),a.settings&&(u=Object.assign(u||{},a.settings))}function P(a){let p=-1;if(a!=null)if(Array.isArray(a))for(;++p<a.length;){const y=a[p];d(y)}else throw new TypeError("Expected a list of plugins, not `"+a+"`")}function x(a,p){let y=-1,E;for(;++y<e.length;)if(e[y][0]===a){E=e[y];break}E?(T(E[1])&&T(p)&&(p=q(!0,E[1],p)),E[1]=p):e.push([...arguments])}}function g(f){i.freeze();const c=I(f),u=i.Parser;return z("parse",u),Q(u,"parse")?new u(String(c),c).parse():u(String(c),c)}function w(f,c){i.freeze();const u=I(c),d=i.Compiler;return V("stringify",d),W(f),Q(d,"compile")?new d(f,u).compile():d(f,u)}function C(f,c,u){if(W(f),i.freeze(),!u&&typeof c=="function"&&(u=c,c=void 0),!u)return new Promise(d);d(null,u);function d(b,P){t.run(f,I(c),x);function x(a,p,y){p=p||f,a?P(a):b?b(p):u(null,p,y)}}}function Z(f,c){let u,d;return i.run(f,c,b),X("runSync","run",d),u;function b(P,x){F(P),u=x,d=!0}}function v(f,c){if(i.freeze(),z("process",i.Parser),V("process",i.Compiler),!c)return new Promise(u);u(null,c);function u(d,b){const P=I(f);i.run(i.parse(P),P,(a,p,y)=>{if(a||!p||!y)x(a);else{const E=i.stringify(p,y);E==null||(we(E)?y.value=E:y.result=E),x(a,y)}});function x(a,p){a||!p?b(a):d?d(p):c(null,p)}}}function ee(f){let c;i.freeze(),z("processSync",i.Parser),V("processSync",i.Compiler);const u=I(f);return i.process(u,d),X("processSync","process",c),u;function d(b){c=!0,F(b)}}}function Q(t,e){return typeof t=="function"&&t.prototype&&(ge(t.prototype)||e in t.prototype)}function ge(t){let e;for(e in t)if(J.call(t,e))return!0;return!1}function z(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `Parser`")}function V(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `Compiler`")}function N(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function W(t){if(!T(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function X(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function I(t){return me(t)?t:new de(t)}function me(t){return Boolean(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function we(t){return typeof t=="string"||U(t)}export{ye as unified};
